---
title: "Hello, its me"
author: "Emily and Stephanie"
date: "3/7/2018"
output: 
  html_document:
    code_folding: hide
---

This chunck loads the tidyverse:
```{r message=FALSE}
library(tidyverse)
```

[LINK TO MINI-PROJECT 2 DESCRIPTION](https://beanumber.github.io/sds192/mod_data.html)

This chunck loads all the files available for the project through 
```{r}
load("house_elections.rda")
load("candidates.rda")
load("committees.rda")
load("contributions.rda")
```


Current Plan:

Design a function to see which top ~5 commities contributed, how much they contributed, and which party the commitie is affiliated with.  Then graph this information in the best way possible.  Then use a facet to graph multiple politians at one time on the same figure.  


Things To Use for Points:

* 2 of the 5 basic words (select(),  mutate(), etc)
* Using a Join 
* If we use a function for this, there is a bonus point involved.  If we start with a function design from the begining, this point will be easier 

Starting to write a function designed to give a tbl for the top 5 committees
```{r}

TopFive<-function(name_arg){
  candidates %>%
  filter(can_name==name_arg)
  
}
```
I think the general plan could be (sorry for spelling errors):

I think Joining Candidates and contributions by Cand_ID is a good plan 

Candidate name = Candidate ID  %>%
Donations for the Candidates from Conrtibutions using Candidate ID  %>%
Referencing back to commitiees data set for the name for committee ID = Commitee name %>%
Sorting descending popularity %>%
head(5)

Generic Plotting Plan:
$ = y-axis
committee = x-axis 
Color of Bars = Political Party 

NEW:


For the following code I selected the columns we care about for Nancy Pelosi to see what it looks like for one candidate and to shrink the dataset.

```{r}
NancyPelosi <- candidates %>%
  select(cand_id, cand_name, cand_party_affiliation) %>%
  filter(cand_name == 'PELOSI, NANCY')
```

I joined two of the three tables that we want

```{r}
cand_contr <- left_join(NancyPelosi, contributions)
```

Here I joined the third table, grouped by the name of the commitee, summarized the contirbution amounts and displayed the top 5.

```{r}
cand_contr_comm <- left_join(cand_contr, committees) %>%
select(cand_id, cand_name, cand_party_affiliation, name, transaction_amt) %>%
  group_by(name) %>%
  summarise(sum = sum(transaction_amt)) %>%
  top_n(5)
```

The top 4 commitees that contibuted to Nacy Pelosi were commitees that fundraised exlussively for her.  The fifth looks like a group that fundraises for Democrats.  Overall, this isn't very interesting.  Maybe we can look at Republicans and see if they took money from the NRA.  Let me know what you think!  



Respons New:
This looks like a really GREAT start! Im going to plot the tbl you made and then see if I can generalize your code into a function:

Chunk below, graphs a bar bones plot.  We need one more variable, the party affiliation of the commitee, so I will see What I can do about trying to add it to the CAND_CONTR_COMM tbl
```{r}
ggplot(cand_contr_comm, aes(x=name, y=sum))+
  geom_histogram(stat="identity") + 
  labs(y="Dollars Contributed", title="Committee Contribution to Nancy Pelosi")
```



Below I started working on a generalized Function that makes the tbl (#1 step at a time):


Makes a large table that joins the data by candidates (In theory this is like the step you did just for Nancy Pelosi, so we should be able to)
```{r}
cand_contrULTRA <- left_join(candidates, contributions) 
```

This gives a master list with all candidates, cand_id, candidates party affiliation, the name of each donation, donation amount, and the type of organization each donation is 
```{r}
cand_cantrULTRA2 <- left_join(cand_contrULTRA, committees) %>%
  select(cand_id, cand_name, cand_party_affiliation, name, transaction_amt, entity_type) 
```


Below, I am working on trying to make the function, but im already encountering a problem, the output has zero rows... I'm not sure why though
```{r}
top_5 <- function(name_arg) {
  cand_cantrULTRA2 %>%
  filter(cand_name == 'name_arg')
}

Nancy<- top_5('PELOSI, NANCY')
Nancy
```




